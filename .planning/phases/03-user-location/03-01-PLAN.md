---
phase: 03-user-location
plan: 01
type: execute
wave: 1
depends_on: ["02-01"]
files_modified:
  - mobile/gradle/libs.versions.toml
  - mobile/composeApp/build.gradle.kts
  - mobile/composeApp/src/androidMain/AndroidManifest.xml
  - mobile/iosApp/iosApp/Info.plist
  - mobile/composeApp/src/commonMain/kotlin/io/asterixorobelix/afrikaburn/platform/LocationService.kt
  - mobile/composeApp/src/androidMain/kotlin/io/asterixorobelix/afrikaburn/platform/LocationService.android.kt
  - mobile/composeApp/src/iosMain/kotlin/io/asterixorobelix/afrikaburn/platform/LocationService.ios.kt
  - mobile/composeApp/src/commonMain/kotlin/io/asterixorobelix/afrikaburn/di/LocationModule.kt
  - mobile/composeApp/src/commonMain/kotlin/io/asterixorobelix/afrikaburn/di/AppModule.kt
  - mobile/composeApp/src/commonMain/kotlin/io/asterixorobelix/afrikaburn/presentation/map/MapUiState.kt
  - mobile/composeApp/src/commonMain/kotlin/io/asterixorobelix/afrikaburn/presentation/map/MapViewModel.kt
  - mobile/composeApp/src/commonMain/kotlin/io/asterixorobelix/afrikaburn/ui/screens/map/MapScreen.kt
  - mobile/composeApp/src/commonMain/kotlin/io/asterixorobelix/afrikaburn/ui/screens/map/UserLocationMarker.kt
  - mobile/composeApp/src/commonMain/kotlin/io/asterixorobelix/afrikaburn/ui/screens/map/MyLocationButton.kt
autonomous: false
user_setup: []

must_haves:
  truths:
    - "User sees blue dot on map at their GPS location"
    - "User can tap FAB to center map on their location"
    - "User is prompted for location permission when first accessing map"
    - "App handles permission denied gracefully (shows message, hides location features)"
    - "GPS tracking stops when leaving map screen (battery conservation)"
  artifacts:
    - path: "mobile/composeApp/src/commonMain/kotlin/io/asterixorobelix/afrikaburn/platform/LocationService.kt"
      provides: "Cross-platform location service interface with expect/actual"
      exports: ["LocationService", "LocationData", "PermissionState"]
    - path: "mobile/composeApp/src/androidMain/kotlin/io/asterixorobelix/afrikaburn/platform/LocationService.android.kt"
      provides: "Android location implementation using FusedLocationProviderClient"
      contains: "actual class"
    - path: "mobile/composeApp/src/iosMain/kotlin/io/asterixorobelix/afrikaburn/platform/LocationService.ios.kt"
      provides: "iOS location implementation using CLLocationManager"
      contains: "actual class"
    - path: "mobile/composeApp/src/commonMain/kotlin/io/asterixorobelix/afrikaburn/ui/screens/map/MapScreen.kt"
      provides: "Map screen with user location dot and My Location FAB"
      contains: "UserLocationMarker"
  key_links:
    - from: "MapViewModel.kt"
      to: "LocationService.kt"
      via: "Koin injection"
      pattern: "locationService"
    - from: "MapScreen.kt"
      to: "MapViewModel.kt"
      via: "UI state observation"
      pattern: "userLocation"
---

<objective>
Add GPS location display to the map screen with a "My Location" button.

Purpose: Users can see where they are on the map and center on their position - critical for navigating the AfrikaBurn event in the desert.
Output: User location dot on map, floating action button to center on location, proper permission handling on both platforms.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
@~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-markers-detail-navigation/02-01-SUMMARY.md

Relevant source files:
@mobile/composeApp/src/commonMain/kotlin/io/asterixorobelix/afrikaburn/ui/screens/map/MapScreen.kt
@mobile/composeApp/src/commonMain/kotlin/io/asterixorobelix/afrikaburn/presentation/map/MapViewModel.kt
@mobile/composeApp/src/commonMain/kotlin/io/asterixorobelix/afrikaburn/presentation/map/MapUiState.kt
@mobile/composeApp/src/commonMain/kotlin/io/asterixorobelix/afrikaburn/di/AppModule.kt
@mobile/composeApp/src/commonMain/kotlin/io/asterixorobelix/afrikaburn/platform/CrashLogger.kt
@mobile/gradle/libs.versions.toml
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add Compass Geolocation library dependency</name>
  <files>mobile/gradle/libs.versions.toml, mobile/composeApp/build.gradle.kts</files>
  <action>
  Add the Compass library for cross-platform geolocation (https://github.com/ArcticOJ/compass-kmp or alternative KMP-compatible location library).

  In libs.versions.toml:
  1. Add version: `compass = "1.2.0"` (or latest stable)
  2. Add library: `compass-geolocation = { module = "dev.icerock.moko:geo", version.ref = "compass" }`
     OR use moko-geo: `moko-geo = "0.6.0"` with `moko-geo = { module = "dev.icerock.moko:geo", version.ref = "moko-geo" }`

  **Preferred approach**: Use moko-geo (dev.icerock.moko:geo) as it's mature and well-tested for KMP:
  - Version: 0.6.0 or latest
  - Provides: LocationTracker interface
  - Works on: Android (FusedLocationProviderClient) and iOS (CLLocationManager)

  In build.gradle.kts commonMain.dependencies:
  ```kotlin
  implementation(libs.moko.geo)
  ```

  **Alternative if moko-geo has issues**: Create custom expect/actual LocationService without library dependency, using:
  - Android: FusedLocationProviderClient directly
  - iOS: CLLocationManager via Kotlin/Native interop

  Verify: `./gradlew :composeApp:compileKotlinIosArm64 :composeApp:compileKotlinAndroid` compiles.
  </action>
  <verify>./gradlew :composeApp:compileKotlinIosArm64 :composeApp:compileKotlinAndroid succeeds</verify>
  <done>Compass/moko-geo library added to version catalog and build.gradle.kts, project compiles</done>
</task>

<task type="auto">
  <name>Task 2: Add platform-specific location permissions</name>
  <files>mobile/composeApp/src/androidMain/AndroidManifest.xml, mobile/iosApp/iosApp/Info.plist</files>
  <action>
  Android - Add to AndroidManifest.xml before `<application>` tag:
  ```xml
  <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
  <uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
  ```

  iOS - Add to Info.plist:
  ```xml
  <key>NSLocationWhenInUseUsageDescription</key>
  <string>AfrikaBurn Companion needs your location to show where you are on the map and help you navigate the event.</string>
  ```

  Do NOT request background location - only "when in use" for battery efficiency in the desert.
  </action>
  <verify>Permissions declared in both platform configs</verify>
  <done>Location permissions added to Android manifest and iOS Info.plist</done>
</task>

<task type="auto">
  <name>Task 3: Create LocationService expect/actual interface</name>
  <files>
    mobile/composeApp/src/commonMain/kotlin/io/asterixorobelix/afrikaburn/platform/LocationService.kt,
    mobile/composeApp/src/androidMain/kotlin/io/asterixorobelix/afrikaburn/platform/LocationService.android.kt,
    mobile/composeApp/src/iosMain/kotlin/io/asterixorobelix/afrikaburn/platform/LocationService.ios.kt
  </files>
  <action>
  Create cross-platform location service following established expect/actual pattern (like CrashLogger).

  **commonMain/platform/LocationService.kt:**
  ```kotlin
  package io.asterixorobelix.afrikaburn.platform

  import kotlinx.coroutines.flow.Flow

  /**
   * Location data from GPS
   */
  data class LocationData(
      val latitude: Double,
      val longitude: Double,
      val accuracy: Float? = null,
      val timestamp: Long = 0L
  )

  /**
   * Location permission state
   */
  enum class PermissionState {
      GRANTED,
      DENIED,
      NOT_DETERMINED
  }

  /**
   * Cross-platform location service interface
   */
  interface LocationService {
      /**
       * Check current permission state
       */
      suspend fun checkPermission(): PermissionState

      /**
       * Request location permission from user
       * Returns the new permission state after user responds
       */
      suspend fun requestPermission(): PermissionState

      /**
       * Start location updates. Emits LocationData at intervals.
       * Call stopLocationUpdates() when done to conserve battery.
       */
      fun startLocationUpdates(): Flow<LocationData>

      /**
       * Stop location updates to conserve battery
       */
      fun stopLocationUpdates()

      /**
       * Get single location fix (one-shot)
       * Returns null if permission denied or location unavailable
       */
      suspend fun getCurrentLocation(): LocationData?
  }

  /**
   * Factory function for creating platform-specific LocationService
   */
  expect fun createLocationService(): LocationService
  ```

  **androidMain/platform/LocationService.android.kt:**
  Implement using Google Play Services FusedLocationProviderClient:
  - Use `LocationServices.getFusedLocationProviderClient(context)`
  - Request updates with Priority.PRIORITY_BALANCED_POWER_ACCURACY (5-second interval for battery)
  - Handle ActivityCompat.checkSelfPermission and requestPermissions
  - Use callbackFlow for location updates

  **iosMain/platform/LocationService.ios.kt:**
  Implement using CLLocationManager:
  - Use desiredAccuracy = kCLLocationAccuracyHundredMeters (battery-efficient)
  - Handle CLLocationManager delegate for permission callbacks
  - Use callbackFlow for didUpdateLocations
  - Use locationManager.requestWhenInUseAuthorization()

  Note: If moko-geo was added in Task 1, wrap its LocationTracker instead of implementing from scratch.
  </action>
  <verify>./gradlew :composeApp:compileKotlinIosArm64 :composeApp:compileKotlinAndroid succeeds</verify>
  <done>LocationService interface and platform implementations created</done>
</task>

<task type="auto">
  <name>Task 4: Create LocationModule and register in DI</name>
  <files>
    mobile/composeApp/src/commonMain/kotlin/io/asterixorobelix/afrikaburn/di/LocationModule.kt,
    mobile/composeApp/src/commonMain/kotlin/io/asterixorobelix/afrikaburn/di/AppModule.kt
  </files>
  <action>
  Create LocationModule.kt:
  ```kotlin
  package io.asterixorobelix.afrikaburn.di

  import io.asterixorobelix.afrikaburn.platform.LocationService
  import io.asterixorobelix.afrikaburn.platform.createLocationService
  import org.koin.dsl.module

  val locationModule = module {
      single<LocationService> { createLocationService() }
  }
  ```

  Update AppModule.kt to include locationModule:
  ```kotlin
  val appModule = module {
      includes(
          crashLoggingModule,
          dataModule,
          domainModule,
          presentationModule,
          locationModule  // Add this
      )
  }
  ```
  </action>
  <verify>./gradlew :composeApp:compileKotlinIosArm64 :composeApp:compileKotlinAndroid succeeds</verify>
  <done>LocationModule created and registered in AppModule</done>
</task>

<task type="auto">
  <name>Task 5: Extend MapUiState with user location fields</name>
  <files>mobile/composeApp/src/commonMain/kotlin/io/asterixorobelix/afrikaburn/presentation/map/MapUiState.kt</files>
  <action>
  Add user location tracking fields to MapUiState.Success:

  ```kotlin
  data class Success(
      val centerLatitude: Double = DEFAULT_CENTER_LATITUDE,
      val centerLongitude: Double = DEFAULT_CENTER_LONGITUDE,
      val zoomLevel: Double = DEFAULT_ZOOM_LEVEL,
      val projects: List<ProjectItem> = emptyList(),
      // Add these new fields:
      val userLatitude: Double? = null,
      val userLongitude: Double? = null,
      val locationPermissionState: PermissionState = PermissionState.NOT_DETERMINED,
      val isTrackingLocation: Boolean = false
  ) : MapUiState {
      /** True if we have valid user location coordinates */
      val hasUserLocation: Boolean
          get() = userLatitude != null && userLongitude != null
  }
  ```

  Import PermissionState from platform package.
  </action>
  <verify>File compiles without errors</verify>
  <done>MapUiState extended with user location and permission state fields</done>
</task>

<task type="auto">
  <name>Task 6: Enhance MapViewModel with location tracking</name>
  <files>
    mobile/composeApp/src/commonMain/kotlin/io/asterixorobelix/afrikaburn/presentation/map/MapViewModel.kt,
    mobile/composeApp/src/commonMain/kotlin/io/asterixorobelix/afrikaburn/di/PresentationModule.kt
  </files>
  <action>
  Update MapViewModel to inject and use LocationService:

  1. Add LocationService as constructor parameter:
  ```kotlin
  class MapViewModel(
      private val locationService: LocationService
  ) : ViewModel() {
  ```

  2. Add location tracking job:
  ```kotlin
  private var locationJob: Job? = null
  ```

  3. Add methods for location handling:
  ```kotlin
  /**
   * Check location permission and start tracking if granted
   */
  fun checkAndRequestLocation() {
      viewModelScope.launch {
          val permission = locationService.checkPermission()
          updatePermissionState(permission)

          if (permission == PermissionState.GRANTED) {
              startLocationTracking()
          }
      }
  }

  /**
   * Request location permission from user
   */
  fun requestLocationPermission() {
      viewModelScope.launch {
          val permission = locationService.requestPermission()
          updatePermissionState(permission)

          if (permission == PermissionState.GRANTED) {
              startLocationTracking()
          }
      }
  }

  /**
   * Start tracking user location
   */
  private fun startLocationTracking() {
      locationJob?.cancel()
      locationJob = viewModelScope.launch {
          locationService.startLocationUpdates()
              .catch { /* Log error, continue without location */ }
              .collect { location ->
                  updateUserLocation(location.latitude, location.longitude)
              }
      }
      updateTrackingState(true)
  }

  /**
   * Stop location tracking to conserve battery
   */
  fun stopLocationTracking() {
      locationJob?.cancel()
      locationJob = null
      locationService.stopLocationUpdates()
      updateTrackingState(false)
  }

  /**
   * Center map on user's current location
   */
  fun centerOnUserLocation() {
      val currentState = _uiState.value
      if (currentState is MapUiState.Success && currentState.hasUserLocation) {
          _uiState.value = currentState.copy(
              centerLatitude = currentState.userLatitude!!,
              centerLongitude = currentState.userLongitude!!
          )
      }
  }

  private fun updateUserLocation(lat: Double, lng: Double) {
      val currentState = _uiState.value
      if (currentState is MapUiState.Success) {
          _uiState.value = currentState.copy(
              userLatitude = lat,
              userLongitude = lng
          )
      }
  }

  private fun updatePermissionState(state: PermissionState) {
      val currentState = _uiState.value
      if (currentState is MapUiState.Success) {
          _uiState.value = currentState.copy(locationPermissionState = state)
      }
  }

  private fun updateTrackingState(tracking: Boolean) {
      val currentState = _uiState.value
      if (currentState is MapUiState.Success) {
          _uiState.value = currentState.copy(isTrackingLocation = tracking)
      }
  }

  override fun onCleared() {
      super.onCleared()
      stopLocationTracking()  // Clean up when ViewModel destroyed
  }
  ```

  4. Update PresentationModule.kt to inject LocationService:
  ```kotlin
  factory { MapViewModel(get()) }
  ```
  </action>
  <verify>./gradlew :composeApp:compileKotlinIosArm64 :composeApp:compileKotlinAndroid succeeds</verify>
  <done>MapViewModel enhanced with location tracking, permission handling, and center-on-location functionality</done>
</task>

<task type="auto">
  <name>Task 7: Create UserLocationMarker composable</name>
  <files>mobile/composeApp/src/commonMain/kotlin/io/asterixorobelix/afrikaburn/ui/screens/map/UserLocationMarker.kt</files>
  <action>
  Create a blue dot marker component for user location:

  ```kotlin
  package io.asterixorobelix.afrikaburn.ui.screens.map

  import androidx.compose.foundation.background
  import androidx.compose.foundation.border
  import androidx.compose.foundation.layout.Box
  import androidx.compose.foundation.layout.size
  import androidx.compose.foundation.shape.CircleShape
  import androidx.compose.material3.MaterialTheme
  import androidx.compose.runtime.Composable
  import androidx.compose.ui.Modifier
  import androidx.compose.ui.draw.shadow
  import androidx.compose.ui.graphics.Color
  import androidx.compose.ui.unit.dp
  import io.asterixorobelix.afrikaburn.Dimens
  import org.jetbrains.compose.ui.tooling.preview.Preview
  import io.asterixorobelix.afrikaburn.AppTheme

  // Material Design 3 blue for user location
  private val USER_LOCATION_COLOR = Color(0xFF2196F3)
  private val USER_LOCATION_SIZE = 16.dp
  private val USER_LOCATION_BORDER = 3.dp

  /**
   * Blue dot marker showing user's current GPS location.
   * Follows standard map conventions with blue fill and white border.
   */
  @Composable
  fun UserLocationMarker(
      modifier: Modifier = Modifier
  ) {
      Box(
          modifier = modifier
              .size(USER_LOCATION_SIZE)
              .shadow(
                  elevation = Dimens.elevationSmall,
                  shape = CircleShape
              )
              .background(
                  color = USER_LOCATION_COLOR,
                  shape = CircleShape
              )
              .border(
                  width = USER_LOCATION_BORDER,
                  color = Color.White,
                  shape = CircleShape
              )
      )
  }

  @Preview
  @Composable
  private fun UserLocationMarkerPreview() {
      AppTheme {
          Box(
              modifier = Modifier
                  .size(100.dp)
                  .background(MaterialTheme.colorScheme.surface)
          ) {
              UserLocationMarker()
          }
      }
  }
  ```

  Note: This composable is for preview/reference. Actual map display uses MapLibre's built-in marker rendering via GeoJSON or CircleLayer positioned at user coordinates.
  </action>
  <verify>File compiles and preview renders</verify>
  <done>UserLocationMarker composable created with blue dot styling</done>
</task>

<task type="auto">
  <name>Task 8: Create MyLocationButton FAB composable</name>
  <files>mobile/composeApp/src/commonMain/kotlin/io/asterixorobelix/afrikaburn/ui/screens/map/MyLocationButton.kt</files>
  <action>
  Create floating action button for centering on user location:

  ```kotlin
  package io.asterixorobelix.afrikaburn.ui.screens.map

  import androidx.compose.material.icons.Icons
  import androidx.compose.material.icons.filled.MyLocation
  import androidx.compose.material3.FloatingActionButton
  import androidx.compose.material3.FloatingActionButtonDefaults
  import androidx.compose.material3.Icon
  import androidx.compose.material3.MaterialTheme
  import androidx.compose.runtime.Composable
  import androidx.compose.ui.Modifier
  import io.asterixorobelix.afrikaburn.Dimens
  import org.jetbrains.compose.ui.tooling.preview.Preview
  import io.asterixorobelix.afrikaburn.AppTheme

  /**
   * Floating action button to center map on user's location.
   *
   * @param onClick Called when button is tapped
   * @param enabled Whether the button is enabled (location available)
   * @param modifier Optional modifier
   */
  @Composable
  fun MyLocationButton(
      onClick: () -> Unit,
      enabled: Boolean = true,
      modifier: Modifier = Modifier
  ) {
      FloatingActionButton(
          onClick = onClick,
          modifier = modifier,
          containerColor = if (enabled) {
              MaterialTheme.colorScheme.primaryContainer
          } else {
              MaterialTheme.colorScheme.surfaceVariant
          },
          contentColor = if (enabled) {
              MaterialTheme.colorScheme.onPrimaryContainer
          } else {
              MaterialTheme.colorScheme.onSurfaceVariant
          },
          elevation = FloatingActionButtonDefaults.elevation(
              defaultElevation = Dimens.elevationSmall
          )
      ) {
          Icon(
              imageVector = Icons.Default.MyLocation,
              contentDescription = "Center on my location"
          )
      }
  }

  @Preview
  @Composable
  private fun MyLocationButtonPreview() {
      AppTheme {
          MyLocationButton(
              onClick = {},
              enabled = true
          )
      }
  }
  ```
  </action>
  <verify>File compiles and preview renders</verify>
  <done>MyLocationButton FAB created with enabled/disabled states</done>
</task>

<task type="auto">
  <name>Task 9: Integrate location features into MapScreen</name>
  <files>mobile/composeApp/src/commonMain/kotlin/io/asterixorobelix/afrikaburn/ui/screens/map/MapScreen.kt</files>
  <action>
  Update MapScreen to display user location and handle permissions:

  1. Add imports for new components and location state

  2. In MapScreen composable, add lifecycle awareness:
  ```kotlin
  // Check permission and start tracking when screen becomes visible
  LaunchedEffect(Unit) {
      viewModel.checkAndRequestLocation()
  }

  // Stop tracking when leaving screen
  DisposableEffect(Unit) {
      onDispose {
          viewModel.stopLocationTracking()
      }
  }
  ```

  3. In MapContent, add user location marker layer inside MaplibreMap:
  ```kotlin
  // User location marker (blue dot)
  val state = uiState as MapUiState.Success
  if (state.hasUserLocation) {
      val userLocationSource = rememberGeoJsonSource(
          data = GeoJsonData.Json("""
              {
                  "type": "Feature",
                  "geometry": {
                      "type": "Point",
                      "coordinates": [${state.userLongitude}, ${state.userLatitude}]
                  },
                  "properties": {}
              }
          """.trimIndent())
      )

      // Blue user location dot
      CircleLayer(
          id = "user-location",
          source = userLocationSource,
          color = const(Color(0xFF2196F3)),
          radius = const(8.dp),
          strokeColor = const(Color.White),
          strokeWidth = const(3.dp)
      )
  }
  ```

  4. Add MyLocationButton FAB in a Box overlay:
  ```kotlin
  Box(modifier = Modifier.fillMaxSize()) {
      MaplibreMap(...) { ... }

      // My Location FAB - bottom right
      if (state.locationPermissionState == PermissionState.GRANTED) {
          MyLocationButton(
              onClick = viewModel::centerOnUserLocation,
              enabled = state.hasUserLocation,
              modifier = Modifier
                  .align(Alignment.BottomEnd)
                  .padding(Dimens.paddingMedium)
          )
      }
  }
  ```

  5. Handle permission not granted - show message or request button:
  ```kotlin
  // If permission not determined, request on first load
  // If denied, show small message or hide location features gracefully
  ```
  </action>
  <verify>./gradlew :composeApp:compileKotlinIosArm64 :composeApp:compileKotlinAndroid succeeds</verify>
  <done>MapScreen displays user location dot and My Location FAB with proper lifecycle management</done>
</task>

<task type="auto">
  <name>Task 10: Build and test</name>
  <files>N/A</files>
  <action>
  Run full build and tests:
  ```bash
  ./gradlew :composeApp:assembleDebug
  ./gradlew :composeApp:testDebugUnitTest
  ./gradlew detekt
  ```

  Fix any compilation errors, test failures, or detekt issues before proceeding to verification.
  </action>
  <verify>All three commands succeed without errors</verify>
  <done>Debug APK builds, all tests pass, detekt clean</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>User location feature with GPS dot and My Location FAB</what-built>
  <how-to-verify>
    1. Run: `./gradlew :composeApp:installDebug` (or run from Android Studio)
    2. Open the app and tap the Map tab
    3. **Permission dialog**: Should see "Allow AfrikaBurn to access your location?" prompt
    4. Tap "Allow" (or "While using the app")
    5. **Blue dot**: After permission granted, a blue dot should appear at your current location
    6. **My Location FAB**: A floating button should appear in bottom-right corner
    7. Pan the map away from your location
    8. Tap the My Location FAB - map should center back on the blue dot
    9. Navigate away from Map tab (to Projects, Directions, or About)
    10. Return to Map tab - location should still work, blue dot visible
    11. **Denied permission test**: If possible, test with location permission denied - FAB should be hidden or disabled
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `./gradlew :composeApp:assembleDebug` succeeds
- [ ] `./gradlew :composeApp:testDebugUnitTest` passes all tests
- [ ] `./gradlew detekt` passes (or only pre-existing issues)
- [ ] User location dot appears on map when permission granted
- [ ] My Location FAB centers map on user
- [ ] Location tracking stops when leaving map screen
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No new errors or warnings introduced
- LOC-01: User sees their GPS location on map (blue dot)
- LOC-02: User can tap FAB to center on their location
- LOC-03: Permission prompt appears when accessing map
- Battery conservation: GPS stops when leaving map
</success_criteria>

<output>
After completion, create `.planning/phases/03-user-location/03-01-SUMMARY.md`
</output>
