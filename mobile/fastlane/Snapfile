# Snapfile - iOS Screenshot Configuration

# Use workspace since CocoaPods provides MapLibre and other dependencies
workspace("./iosApp/iosApp.xcworkspace")

# Scheme with UI tests attached
scheme("iosApp")

# Devices to capture screenshots on
devices([
  "iPhone 16 Pro Max",
  "iPad Pro 13-inch (M4)"
])

# Languages to capture screenshots in
languages([
  "en-US"
])

# Output directory for screenshots
output_directory("./fastlane/screenshots/ios")

# Clear previous screenshots before capturing new ones
clear_previous_screenshots(true)

# Override status bar for clean screenshots
override_status_bar(true)
override_status_bar_arguments("--time 9:41 --batteryState charged --batteryLevel 100")

# Don't run simulators in parallel (KMP can have issues with parallel builds)
concurrent_simulators(false)

# Stop immediately if one device/language fails
stop_after_first_error(true)

# Avoid rerun loops
number_of_retries(0)

# Force single-worker execution
xcargs("-parallel-testing-enabled NO -maximum-parallel-testing-workers 1")

# Skip opening HTML summary in CI
skip_open_summary(ENV['CI'] == 'true')

# Reinstall app for each language (ensures clean state)
reinstall_app(true)

# Don't erase simulator (faster)
erase_simulator(false)
